---

- name: "{{ test }}"
  hosts: debian
  become: true
  vars:
    manala_environment_files:
      - pam
      - zsh
      - file:   /etc/profile.d/test.sh
        export: true
    manala_environment_variables:
      - FOO: bar
      - BAR: 123
      - BAZ: 1.2
      - QUX: foo=bar
      - FOO_NULL:  null
      - FOO_TRUE:  true
      - FOO_FALSE: false
  pre_tasks:
    - copy:
        dest: /etc/environment
        content: |
          _FOO="bar"
          _BAR="123"
    - file:
        path: /etc/zsh
        state: directory
    - copy:
        dest: /etc/zsh/zshenv
        content: |
          # /etc/zsh/zshenv
    - copy:
        dest: /etc/profile.d/test.sh
        content: |
          # /etc/profile.d/test.sh
  roles:
    - manala.environment
  post_tasks:
    - name: Goss
      command: goss --gossfile {{ test }}.goss.yml validate
